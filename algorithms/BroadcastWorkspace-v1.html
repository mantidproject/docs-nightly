<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Description</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=4468db6d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9aca6aaf" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=424816ac"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CNCSSuggestTIB v1" href="CNCSSuggestTIB-v1.html" />
    <link rel="prev" title="BinaryOperateMasks v1" href="BinaryOperateMasks-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





<nav id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div id="navbar-main" class="container">
    <ul class="nav navbar-nav">
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <li>
        <a class="navbar-brand" href="http://www.mantidproject.org">
         </a>
      </li>
      <span class="navbar-text navbar-version pull-left"><b>6.14</b></span>
    </ul>

    
    <div class="collapse navbar-collapse nav-collapse">
    
      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          <li>
            <a href="https://www.mantidproject.org">Home</a>
          </li>
          <li>
            <a href="https://download.mantidproject.org">Download</a>
          </li>
          <li>
            <a href="https://docs.mantidproject.org">Documentation</a>
          </li>
          <li>
            <a href="https://www.mantidproject.org/contact">Contact Us</a>
          </li>
        
        
          
          
        
        
        
        
      </ul>
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
  </div> <!-- /navbar-main -->
<div id="navbar-breadcrumbs" class="related" role="navigation" aria-label="related navigation">
  <h3>Navigation</h3>
  <ul>
    <li class="nav-item nav-item-0">
      <a href="../index.html">Documentation</a>
         &#187;
    </li>
    
    <li class="nav-item nav-item-1">
      <a href="index.html" accesskey="U">
        Algorithms
      </a>
       &#187;
    </li>
    
    
    
    
    <li class="nav-item nav-item-this">
      <a href="">Description</a>
    </li>
    
    
  </ul>
</div>
</nav>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><strong>ERROR: No algorithm ‘BroadcastWorkspace’ version ‘1’, skipping directive</strong></p>
<p><strong>ERROR: No algorithm ‘BroadcastWorkspace’ version ‘1’, skipping directive</strong></p>
<p><strong>ERROR: No algorithm ‘BroadcastWorkspace’ version ‘1’, skipping directive</strong></p>
<p><strong>ERROR: No algorithm ‘BroadcastWorkspace’ version ‘1’, skipping directive</strong></p>
<section id="description">
<h1>Description<a class="headerlink" href="#description" title="Link to this heading">¶</a></h1>
<p>BroadcastWorkspace distributes a workspace from one MPI process (the broadcaster) to all other processes in the MPI job.
Only the broadcaster rank needs to provide an input workspace; all other ranks will receive an identical copy as their output.
The algorithm is optimized for large workspaces through chunked broadcasting,
which processes the data in manageable pieces to balance memory usage and performance.
When spectra share identical X data, the algorithm broadcasts the X array only once and shares it across all spectra in the output workspace,
reducing both transmission time and memory footprint.
This is a collective MPI operation, meaning all processes in the communicator must call the algorithm simultaneously or the job will hang.</p>
</section>
<section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h1>
<p><strong>Example - Simple Broadcast</strong></p>
<p>The following code should be saved as <code class="docutils literal notranslate"><span class="pre">broadcast.py</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mantid.simpleapi</span><span class="w"> </span><span class="kn">import</span> <span class="n">CreateWorkspace</span><span class="p">,</span> <span class="n">BroadcastWorkspace</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpi4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">MPI</span>

<span class="n">comm</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span>
<span class="n">rank</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">Get_rank</span><span class="p">()</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">Get_size</span><span class="p">()</span>

<span class="c1"># Only rank 0 creates the workspace to broadcast</span>
<span class="n">input_ws</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rank </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">: Creating workspace to broadcast&quot;</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span>
        <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span>
        <span class="mf">9.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">]</span>
    <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span>
        <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>

    <span class="n">input_ws</span> <span class="o">=</span> <span class="n">CreateWorkspace</span><span class="p">(</span>
        <span class="n">DataX</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">DataY</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">DataE</span><span class="o">=</span><span class="n">e</span><span class="p">,</span>
        <span class="n">NSpec</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s2">&quot;input_ws&quot;</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rank </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">: Created workspace with </span><span class="si">{</span><span class="n">input_ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()</span><span class="si">}</span><span class="s2"> spectra&quot;</span><span class="p">)</span>

<span class="c1"># All ranks participate in the broadcast</span>
<span class="c1"># Only rank 0 needs to provide InputWorkspace</span>
<span class="k">if</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">output_ws</span> <span class="o">=</span> <span class="n">BroadcastWorkspace</span><span class="p">(</span>
        <span class="n">InputWorkspace</span><span class="o">=</span><span class="n">input_ws</span><span class="p">,</span>
        <span class="n">BroadcasterRank</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s2">&quot;output_ws&quot;</span>
    <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Other ranks don&#39;t provide InputWorkspace</span>
    <span class="n">output_ws</span> <span class="o">=</span> <span class="n">BroadcastWorkspace</span><span class="p">(</span>
        <span class="n">BroadcasterRank</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">OutputWorkspace</span><span class="o">=</span><span class="s2">&quot;output_ws&quot;</span>
    <span class="p">)</span>

<span class="c1"># All ranks now have the workspace</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rank </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">: Received workspace with </span><span class="si">{</span><span class="n">output_ws</span><span class="o">.</span><span class="n">getNumberHistograms</span><span class="p">()</span><span class="si">}</span><span class="s2"> spectra&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">rank</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rank </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">: First spectrum Y values: </span><span class="si">{</span><span class="n">output_ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rank </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">: Last spectrum Y values: </span><span class="si">{</span><span class="n">output_ws</span><span class="o">.</span><span class="n">readY</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpiexec<span class="w"> </span>-n<span class="w"> </span><span class="m">4</span><span class="w"> </span>broadcast.py
</pre></div>
</div>
<p>Output:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to nature of MPI, the output may be recieved out of order</p>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Rank 0: Creating workspace to broadcast
Rank 0: Created workspace with 3 spectra
Rank 0: Received workspace with 3 spectra
Rank 1: Received workspace with 3 spectra
Rank 1: First spectrum Y values: [1. 2. 3. 4.]
Rank 1: Last spectrum Y values: [ 9. 10. 11. 12.]
Rank 2: Received workspace with 3 spectra
Rank 2: First spectrum Y values: [1. 2. 3. 4.]
Rank 2: Last spectrum Y values: [ 9. 10. 11. 12.]
Rank 3: Received workspace with 3 spectra
Rank 3: First spectrum Y values: [1. 2. 3. 4.]
Rank 3: Last spectrum Y values: [ 9. 10. 11. 12.]
</pre></div>
</div>
<p><strong>ERROR: No algorithm ‘BroadcastWorkspace’ version ‘1’, skipping directive</strong></p>
<p><strong>ERROR: No algorithm ‘BroadcastWorkspace’ version ‘1’, skipping directive</strong></p>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul id="footer-nav" class="nav navbar-nav">
      
      
          
            
  <li>
    <a href="BinaryOperateMasks-v1.html" title="Previous Chapter: BinaryOperateMasks v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; BinaryOperateMasks v1</span>
    </a>
  </li>
  <li>
    <a href="CNCSSuggestTIB-v1.html" title="Next Chapter: CNCSSuggestTIB v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">CNCSSuggestTIB v1 &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>