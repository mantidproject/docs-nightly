<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DetermineSpinStateOrder v1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=fadd4351" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=77160d70" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=84e6de61"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DgsAbsoluteUnitsReduction v1" href="DgsAbsoluteUnitsReduction-v1.html" />
    <link rel="prev" title="DetermineChunking v1" href="DetermineChunking-v1.html" />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59110517-1', 'auto');
  ga('send', 'pageview');

</script>


  </head><body>





  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.mantidproject.org">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>6.13</b></span>
      </div>

      
        <div class="collapse navbar-collapse nav-collapse">
      
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.mantidproject.org">Home</a></li>
                <li><a href="https://download.mantidproject.org">Download</a></li>
                <li><a href="https://docs.mantidproject.org">Documentation</a></li>
                <li><a href="https://www.mantidproject.org/contact">Contact Us</a></li>
            
            
              
              
            
            
            
            
          </ul>
              
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
            </div>
    </div>
    <p>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>
        
            <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Algorithms</a> &#187;</li>
          
        
        
          
            <li class="nav-item nav-item-this"><a href="">DetermineSpinStateOrder v1</a></li>
          
        
      </ul>
    </div> </p>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <p><span class="math notranslate nohighlight">\(\renewcommand\AA{\unicode{x212B}}\)</span></p>
<section id="determinespinstateorder-v1">
<span id="algm-determinespinstateorder"></span><span id="algm-determinespinstateorder-v1"></span><h1>DetermineSpinStateOrder v1<a class="headerlink" href="#determinespinstateorder-v1" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<span id="index-0"></span><p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#summary" id="id1">Summary</a></p></li>
<li><p><a class="reference internal" href="#properties" id="id2">Properties</a></p></li>
<li><p><a class="reference internal" href="#description" id="id3">Description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id4">Usage</a></p></li>
<li><p><a class="reference internal" href="#source" id="id5">Source</a></p></li>
</ul>
</nav>
<section id="summary">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<p>Takes a workspace group of Polarised SANS run periods and returns a string (e.g ‘11, 10, 01, 00’) of their corresponding spin states in Wildes notation.</p>
</section>
<section id="properties">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Properties</a><a class="headerlink" href="#properties" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>InputWorkspace</p></td>
<td><p>Input</p></td>
<td><p>WorkspaceGroup</p></td>
<td><p><em>Mandatory</em></p></td>
<td><p>A Polarised SANS run from either LARMOR or ZOOM (group workspace with 4 periods).</p></td>
</tr>
<tr class="row-odd"><td><p>SpinFlipperLogName</p></td>
<td><p>Input</p></td>
<td><p>string</p></td>
<td></td>
<td><p>Name of the log contained in the InputWorkspace which holds the flipper current (can be inferred if data is from LARMOR or ZOOM).</p></td>
</tr>
<tr class="row-even"><td><p>SpinFlipperAverageCurrent</p></td>
<td><p>Input</p></td>
<td><p>number</p></td>
<td><p><em>Optional</em></p></td>
<td><p>Expected average current for the spin slipper over all periods. Used to determine if a particular period has the flipper active or not (can be inferred if data is from LARMOR or ZOOM).</p></td>
</tr>
<tr class="row-odd"><td><p>SpinStates</p></td>
<td><p>Output</p></td>
<td><p>string</p></td>
<td></td>
<td><p>A comma-seperated string of the spin states of each of the run periods e.g ‘11, 10, 01, 00’</p></td>
</tr>
</tbody>
</table>
</section>
<section id="description">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Description</a><a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>Takes a Polarised SANS transmission run and attempts to determine the spin state for each run period.</p>
<p>The average current through the RF flipper for every run is extracted from the appropriate spin flipper log in the instrument. The beam polarisation is determined by
comparing each period transmission to the average transmission (greater than the average suggests the same state as the flipper).</p>
<p>If the data is from LARMOR or ZOOM, properties <strong>SpinFlipperLogName</strong> and <strong>SpinFlipperAverageCurrent</strong> can be inferred by the algorithm.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Instrument | <strong>SpinFlipperLogName</strong> | <strong>SpinFlipperAverageCurrent</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="3"><p>LARMOR     | <code class="docutils literal notranslate"><span class="pre">FlipperCurrent</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">4.0</span></code></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p>ZOOM       | <code class="docutils literal notranslate"><span class="pre">Spin_flipper</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.0</span></code></p></td>
</tr>
</tbody>
</table>
<p>Otherwise, they can be supplied explicitly by the user.</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p><strong>Example - DetermineSpinStateOrder</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mantid.simpleapi</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mantid.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">WorkspaceGroup</span>

<span class="n">wsGroup</span> <span class="o">=</span> <span class="n">WorkspaceGroup</span><span class="p">()</span>
<span class="n">mtd</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">wsGroup</span><span class="p">)</span>
<span class="n">y_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="n">flipper_current_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.8</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">ws_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ws_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">CreateSampleWorkspace</span><span class="p">(</span><span class="s2">&quot;Histogram&quot;</span><span class="p">,</span> <span class="s2">&quot;Flat background&quot;</span><span class="p">,</span> <span class="n">XUnit</span><span class="o">=</span><span class="s2">&quot;Wavelength&quot;</span><span class="p">,</span> <span class="n">XMin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">XMax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">BinWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumEvents</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">InstrumentName</span><span class="o">=</span><span class="s2">&quot;LARMOR&quot;</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">ws_name</span><span class="p">)</span>
    <span class="n">CropWorkspace</span><span class="p">(</span><span class="n">ws_name</span><span class="p">,</span> <span class="n">StartWorkspaceIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">EndWorkspaceIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">ws_name</span><span class="p">)</span>
    <span class="n">mtd</span><span class="p">[</span><span class="n">ws_name</span><span class="p">]</span> <span class="o">*=</span> <span class="n">y_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">AddTimeSeriesLog</span><span class="p">(</span><span class="n">ws_name</span><span class="p">,</span> <span class="s2">&quot;FlipperCurrent&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-01-01T00:00:00&quot;</span><span class="p">,</span> <span class="n">flipper_current_values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">wsGroup</span><span class="o">.</span><span class="n">addWorkspace</span><span class="p">(</span><span class="n">mtd</span><span class="p">[</span><span class="n">ws_name</span><span class="p">])</span>

<span class="n">ConvertToHistogram</span><span class="p">(</span><span class="n">wsGroup</span><span class="p">,</span> <span class="n">OutputWorkspace</span><span class="o">=</span><span class="n">wsGroup</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">DetermineSpinStateOrder</span><span class="p">(</span><span class="n">wsGroup</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spin state order from wsGroup is </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Spin state order from wsGroup is 01,00,10,11
</pre></div>
</div>
<p><strong>Categories</strong>: <a class="reference external" href="categories/AlgorithmIndex.html">AlgorithmIndex</a> | <a class="reference external" href="categories/SANS.html">SANS</a></p>
</section>
<section id="source">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Source</a><a class="headerlink" href="#source" title="Link to this heading">¶</a></h2>
<p>C++ header: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/6ca90bf59f838fdfd9e66f543d7ddf499bd9133f/Framework/Algorithms/inc/MantidAlgorithms/DetermineSpinStateOrder.h">DetermineSpinStateOrder.h</a></p>
<p>C++ source: <a class="reference external" href="https://github.com/mantidproject/mantid/blob/6ca90bf59f838fdfd9e66f543d7ddf499bd9133f/Framework/Algorithms/src/DetermineSpinStateOrder.cpp">DetermineSpinStateOrder.cpp</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
      <ul class="nav navbar-nav" style=" float: right;">
      
      
          
            
  <li>
    <a href="DetermineChunking-v1.html" title="Previous Chapter: DetermineChunking v1"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; DetermineChunking v1</span>
    </a>
  </li>
  <li>
    <a href="DgsAbsoluteUnitsReduction-v1.html" title="Next Chapter: DgsAbsoluteUnitsReduction v1"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">DgsAbsoluteUn... &raquo;</span>
    </a>
  </li>
          
       
          <li><a href="#">Back to top</a></li>
       </ul>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>